<div class="admin-container">
  <!-- Navigation Header -->
  <nav class="admin-nav">
    <div class="nav-content">
      <div class="nav-brand">
        <h1 class="brand-title">Sri Srinivasa Nilayam</h1>
        <span class="brand-subtitle">Admin Dashboard</span>
      </div>
      <button class="logout-button" (click)="logout()">Logout</button>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon total">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11l3 3L22 4"></path>
            <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path>
          </svg>
        </div>
        <div class="stat-info">
          <h3 class="stat-value">{{ totalRequests }}</h3>
          <p class="stat-label">Total Requests</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon new">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
        </div>
        <div class="stat-info">
          <h3 class="stat-value">{{ newRequests }}</h3>
          <p class="stat-label">New Requests</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon assigned">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
            <circle cx="8.5" cy="7" r="4"></circle>
            <line x1="20" y1="8" x2="20" y2="14"></line>
            <line x1="23" y1="11" x2="17" y2="11"></line>
          </svg>
        </div>
        <div class="stat-info">
          <h3 class="stat-value">{{ assignedRequests }}</h3>
          <p class="stat-label">Assigned</p>
        </div>
      </div>
    </div>

    <!-- Requests Table -->
    <div class="table-card">
      <div class="card-header">
        <h2 class="card-title">Maintenance Requests</h2>
        <p class="card-subtitle">Manage and assign requests to technicians</p>
      </div>

      <div class="table-container">
        <table class="requests-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Category</th>
              <th>Description</th>
              <th>Technician</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of requests">
              <td class="id-cell">#{{ r.id }}</td>
              <td>
                <span class="category-badge">{{ r.category }}</span>
              </td>
              <td class="description-cell">{{ r.description }}</td>
              <td class="technician-cell">
                <select
                  *ngIf="r.status === 'New'"
                  [(ngModel)]="selectedTech[r.id]"
                  class="tech-select">
                  <option value="">Select technician</option>
                  <option *ngFor="let t of technicians" [value]="t.id">
                    {{ t.name }}
                  </option>
                </select>

                <span *ngIf="r.status !== 'New'" [class.assigned-tech]="r.technician_name" [class.not-assigned]="!r.technician_name">
                  {{ r.technician_name || 'Not Assigned' }}
                </span>
              </td>
              <td>
                <span [class]="'status-badge status-' + (r.status || 'new').toLowerCase().replace('-', '')">
                  {{ r.status }}
                </span>
              </td>
              <td>
                <button
                  *ngIf="r.status === 'New'"
                  [disabled]="!selectedTech[r.id]"
                  (click)="assign(r.id)"
                  class="assign-button">
                  Assign
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
